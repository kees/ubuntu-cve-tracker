
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-96529618-15"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-96529618-15');
</script>
<title>Ubuntu OVAL</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Ubuntu CVE Tracker" />
<meta name="copyright" content="Canonical Ltd" />

<link rel="icon" type="image/png" href="https://assets.ubuntu.com/v1/cb22ba5d-favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="https://assets.ubuntu.com/v1/49a1a858-favicon-32x32.png" sizes="32x32" />

<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet" type="text/css">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="../cve/css/starter-template.css">
<link rel="stylesheet" href="../cve/css/starter-template.css">
<link rel="stylesheet" href="../cve/css/cve_tracker.css" type="text/css" />

</head>

<body>
<nav class="navbar navbar-expand navbar-dark bg-dark navbar-fixed-top cve-tracker-navbar">
    <a class="navbar-brand" href="https://ubuntu.com/security/notices/">Ubuntu Security Notices</a>
    <div id="cve-tracker-navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="active nav-link" href=".">OVAL</a></li>
      </ul>
    </div><!--/.nav-collapse -->
</nav>

<div class="container" id="container">
<div class="starter-template">
<div class="card" id="body-card">
<h3 class="card-header">Ubuntu OVAL Data</h3>
<div class="card-body text-left">

Canonical produces data using the Open Vulnerability and Assessment Language (<a href=https://oval.mitre.org/about/>OVAL</a>) . This data can be used to scan an Ubuntu system or an official Ubuntu  OCI image for known vulnerabilities caused from missing patches. The Ubuntu Security Team provides OVAL for all <a href=https://wiki.ubuntu.com/Releases> supported Ubuntu releases</a>. <br>
<br>
The primary method for consuming this data for your system is OpenSCAP. 
<br><br>
<b><u> Using OpenSCAP </b></u><br>
First you will need to download the compressed XML .  <br>
<font face=courier>wget https://security-metadata.canonical.com/oval/com.ubuntu.$(lsb_release -cs).usn.oval.xml.bz2 <br></font>
Uncompress the data <br>
<font face=courier>bunzip2 com.ubuntu.$(lsb_release -cs).usn.oval.xml.bz2  <br> </font>
Next use openscap to evaluate the OVAL and generate an html report <br>
<font face=courier>oscap oval eval --report report.htm com.ubuntu.$(lsb_release -cs).usn.oval.xml  <br></font>
The output is generated in the file report.htm, open it using your browser <br>
<font face=courier>xdg-open report.htm </font>
<br><br> 
<b><u> Scanning an OCI Image</b></u> <br>
To scan an Ubuntu Official Cloud Images for known vulnerabilities the manifest file and xml data can be used together. Unlike above where we were able to use the lsb_release command you will need to manually enter the URL for the OVAL data. In the example below we are using bionic/18.04, you would replace this with the version you are inspecting. 
<br>
<font face=courier>wget https://security-metadata.canonical.com/oval/oci.com.ubuntu.<b>bionic</b>.usn.oval.xml.bz2 <br>
bunzip2 oci.com.ubuntu.<b>bionic</b>.usn.oval.xml.bz2 <br></font>

Next one would download the manifest file for the image. <br>
<font face=courier>wget -O manifest https://cloud-images.ubuntu.com/releases/<b>bionic</b>/release/ubuntu-<b>18.04</b>-server-cloudimg-amd64-root.manifest <br></font>
Next use openscap to evaluate the OVAL and generate an html report <br>
<font face=courier>oscap oval eval --report report.htm oci.com.ubuntu.bionic.usn.oval.xml  <br></font>
The output is generated in the file report.htm, open it using your browser <br>
<font face=courier>xdg-open report.htm <br></font>

<br>
<b><u> Conventions</b></u> <br>
The files are named using the convention: 
<font face=courier> com.ubuntu.releaseName.usn.oval.xml.bz2</font> <br>
And for OCI images they use the same format with "oci." prepended. <br>
<font face=courier> oci.com.ubuntu.releaseName.usn.oval.xml.bz2</font><br>

Additional, OVAL data containing information about all the CVEs the
Ubuntu Security Team tracks are provided, including currently unfixed
issues. The convention for these files is:
<font face=courier> com.ubuntu.releaseName.cve.oval.xml.bz2</font> <br>
And for OCI images they use the same format with "oci." prepended. <br>
<font face=courier> oci.com.ubuntu.releaseName.cve.oval.xml.bz2</font><br>


<div>
<div id="footer">
&copy; Canonical Ltd. 2007-2021
</div><!-- footer -->
</div><!-- card-body -->
</div><!-- card -->
</div><!-- starter-template -->
</div> <!-- container -->
</body>
</html>

