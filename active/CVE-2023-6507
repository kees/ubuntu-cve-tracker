Candidate: CVE-2023-6507
PublicDate: 2023-12-11
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6507
 https://mail.python.org/archives/list/security-announce@python.org/thread/AUL7QFHBLILGISS7U63B47AYSSGJJQZD/
Description:
 An issue was found in CPython 3.12.0 `subprocess` module on POSIX
 platforms. The issue was fixed in CPython 3.12.1 and does not affect other
 stable releases.
 
 When using the `extra_groups=` parameter with an empty list as a value (ie
 `extra_groups=[]`) the logic regressed to not call `setgroups(0, NULL)`
 before calling `exec()`, thus not dropping the original processes' groups
 before starting the new process. There is no issue when the parameter isn't
 used or when any value is used besides an empty list.
 
 This issue only impacts CPython processes run with sufficient privilege to
 make the `setgroups` system call (typically `root`).
 
 
Ubuntu-Description:
Notes:
 mdeslaur> only affects 3.12.0, no earlier releases
Mitigation:
Bugs:
 https://github.com/python/cpython/issues/112334
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N [4.9 MEDIUM]

Patches_python2.7:
upstream_python2.7: not-affected (debian: Vulnerable code not present)
trusty_python2.7: ignored (end of standard support)
trusty/esm_python2.7: not-affected
xenial_python2.7: ignored (end of standard support)
esm-infra/xenial_python2.7: not-affected
bionic_python2.7: ignored (end of standard support)
esm-infra/bionic_python2.7: not-affected
focal_python2.7: not-affected
esm-apps/focal_python2.7: not-affected
jammy_python2.7: not-affected
esm-apps/jammy_python2.7: not-affected
lunar_python2.7: DNE
mantic_python2.7: DNE
devel_python2.7: DNE

Patches_python3.10:
upstream_python3.10: not-affected (debian: Vulnerable code not present)
trusty_python3.10: ignored (end of standard support)
xenial_python3.10: ignored (end of standard support)
bionic_python3.10: ignored (end of standard support)
focal_python3.10: DNE
jammy_python3.10: not-affected
lunar_python3.10: DNE
mantic_python3.10: DNE
devel_python3.10: DNE

Patches_python3.11:
upstream_python3.11: not-affected (debian: Vulnerable code not present)
trusty_python3.11: ignored (end of standard support)
xenial_python3.11: ignored (end of standard support)
bionic_python3.11: ignored (end of standard support)
focal_python3.11: DNE
jammy_python3.11: not-affected
lunar_python3.11: not-affected
mantic_python3.11: not-affected
devel_python3.11: not-affected

Patches_python3.12:
 upstream: https://github.com/python/cpython/pull/112617
upstream_python3.12: released (3.12.1-1)
trusty_python3.12: ignored (end of standard support)
xenial_python3.12: ignored (end of standard support)
bionic_python3.12: ignored (end of standard support)
focal_python3.12: DNE
jammy_python3.12: DNE
lunar_python3.12: DNE
mantic_python3.12: needed
devel_python3.12: not-affected (3.12.1-2)

Patches_python3.7:
upstream_python3.7: not-affected (debian: Vulnerable code not present)
trusty_python3.7: ignored (end of standard support)
xenial_python3.7: ignored (end of standard support)
bionic_python3.7: ignored (end of standard support)
esm-apps/bionic_python3.7: not-affected
focal_python3.7: DNE
jammy_python3.7: DNE
lunar_python3.7: DNE
mantic_python3.7: DNE
devel_python3.7: DNE

Patches_python3.9:
upstream_python3.9: not-affected (debian: Vulnerable code not present)
trusty_python3.9: ignored (end of standard support)
xenial_python3.9: ignored (end of standard support)
bionic_python3.9: ignored (end of standard support)
focal_python3.9: not-affected
esm-apps/focal_python3.9: not-affected
jammy_python3.9: DNE
lunar_python3.9: DNE
mantic_python3.9: DNE
devel_python3.9: DNE
