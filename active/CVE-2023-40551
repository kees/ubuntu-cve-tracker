Candidate: CVE-2023-40551
PublicDate: 2024-01-29 17:15:00 UTC
CRD: 2024-01-23
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40551
Description:
 A flaw was found in the MZ binary format in Shim. An out-of-bounds read may
 occur, leading to a crash or possible exposure of sensitive data during the
 system's boot phase.
Ubuntu-Description:
 [pe-relocate: Fix bounds check for MZ binaries
 In read_header(), we attempt to parse the PE binary headers.  In doing
 so, if there is an MZ (i.e. MS-DOS) header, we locate the PE header by
 finding the offset in that header.  Unfortunately that is not correctly
 bounds checked, and carefully chosen values can cause an out-of-bounds
 ready beyond the end of the loaded binary.
 Unfortunately the trivial fix (bounds check that value) also makes it
 clear that the way we were determining if an image is loadable on this
 platform and distinguishing between PE32 and PE32+ binaries has the
 exact same issue going on, and so the fix includes reworking that logic
 to correctly bounds check all of those tests as well.
 It's not currently known if this is actually exploitable beyond creating
 a denial of service, and an attacker who is in a position to use it for
 a denial of service attack must already be able to do so.]
Notes:
 eslerm> UEFI Security Response Team states that dbx update is not needed
 eslerm> secureboot-db should only ever be updated after shim
 eslerm> secureboot-db is not updated on ESM releases as doing so would
 eslerm> revoke install media keys Note that key revocation is required to
 eslerm> protect against evil housekeeper attacks (such as BlackLotus)
Mitigation:
Bugs:
Priority: medium
Discovered-by: Greg Kirkpatrick
Assigned-to:
CVSS:

Patches_secureboot-db:
upstream_secureboot-db: not-affected (sbat only update)
trusty_secureboot-db: ignored (end of standard support)
trusty/esm_secureboot-db: not-affected (sbat only update)
xenial_secureboot-db: ignored (end of standard support)
esm-infra/xenial_secureboot-db: not-affected (sbat only update)
bionic_secureboot-db: ignored (end of standard support)
esm-infra/bionic_secureboot-db: not-affected (sbat only update)
focal_secureboot-db: not-affected (sbat only update)
jammy_secureboot-db: not-affected (sbat only update)
lunar_secureboot-db: ignored (end of life, was needs-triage)
mantic_secureboot-db: not-affected (sbat only update)
devel_secureboot-db: not-affected (sbat only update)

Patches_shim-signed:
upstream_shim-signed: needs-triage
trusty_shim-signed: ignored (end of standard support)
trusty/esm_shim-signed: ignored (install media keys will never be revoked)
xenial_shim-signed: ignored (end of standard support)
esm-infra/xenial_shim-signed: ignored (install media keys will never be revoked)
bionic_shim-signed: ignored (end of standard support)
esm-infra/bionic_shim-signed: needs-triage
focal_shim-signed: needs-triage
jammy_shim-signed: needs-triage
lunar_shim-signed: ignored (end of life, was needs-triage)
mantic_shim-signed: needs-triage
devel_shim-signed: needs-triage

Patches_shim:
 upstream: https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab
upstream_shim: needs-triage
trusty_shim: ignored (end of standard support)
trusty/esm_shim: ignored (install media keys will never be revoked)
xenial_shim: ignored (end of standard support)
esm-infra/xenial_shim: ignored (install media keys will never be revoked)
bionic_shim: ignored (end of standard support)
esm-infra/bionic_shim: needs-triage
focal_shim: needs-triage
jammy_shim: needs-triage
lunar_shim: ignored (end of life, was needs-triage)
mantic_shim: needs-triage
devel_shim: needs-triage
