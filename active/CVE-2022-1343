PublicDateAtUSN: 2022-05-03
Candidate: CVE-2022-1343
PublicDate: 2022-05-03 16:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1343
 https://mta.openssl.org/pipermail/openssl-announce/2022-May/000224.html
 https://ubuntu.com/security/notices/USN-5402-1
Description:
 The function `OCSP_basic_verify` verifies the signer certificate on an OCSP
 response. In the case where the (non-default) flag OCSP_NOCHECKS is used
 then the response will be positive (meaning a successful verification) even
 in the case where the response signing certificate fails to verify. It is
 anticipated that most users of `OCSP_basic_verify` will not use the
 OCSP_NOCHECKS flag. In this case the `OCSP_basic_verify` function will
 return a negative value (indicating a fatal error) in the case of a
 certificate verification failure. The normal expected return value in this
 case would be 0. This issue also impacts the command line OpenSSL "ocsp"
 application. When verifying an ocsp response with the "-no_cert_checks"
 option the command line application will report that the verification is
 successful even though it has in fact failed. In this case the incorrect
 successful response will also be accompanied by error messages showing the
 failure and contradicting the apparently successful result. Fixed in
 OpenSSL 3.0.3 (Affected 3.0.0,3.0.1,3.0.2).
Ubuntu-Description: 
Notes: 
 mdeslaur> OpenSSL v3.x only
Mitigation: 
Bugs: 
Priority: medium
Discovered-by: Raul Metsma
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N [5.3 MEDIUM]


Patches_openssl:
 upstream: https://git.openssl.org/?p=openssl.git;a=commit;h=2eda98790c5c2741d76d23cc1e74b0dc4f4b391a
 upstream: https://git.openssl.org/?p=openssl.git;a=commit;h=55c80c222293a972587004c185dc5653ae207a0e (test)
upstream_openssl: released (3.0.3)
trusty/esm_openssl: not-affected (v3.x only)
esm-infra/xenial_openssl: not-affected (v3.x only)
fips/xenial_openssl: needs-triage
fips-updates/xenial_openssl: needs-triage
bionic_openssl: not-affected (v3.x only)
fips/bionic_openssl: needs-triage
fips-updates/bionic_openssl: needs-triage
focal_openssl: not-affected (v3.x only)
fips/focal_openssl: needs-triage
fips-updates/focal_openssl: needs-triage
impish_openssl: not-affected (v3.x only)
jammy_openssl: released (3.0.2-0ubuntu1.1)
kinetic_openssl: released (3.0.2-0ubuntu2)
devel_openssl: released (3.0.2-0ubuntu2)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: not-affected
focal_openssl1.0: DNE
impish_openssl1.0: DNE
jammy_openssl1.0: DNE
kinetic_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
trusty_nodejs: ignored (out of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
impish_nodejs: not-affected (uses system openssl1.1)
jammy_nodejs: not-affected (uses system openssl1.1)
kinetic_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
upstream_edk2: needs-triage
trusty_edk2: ignored (out of standard support)
trusty/esm_edk2: DNE
xenial_edk2: ignored (end of standard support)
bionic_edk2: not-affected
focal_edk2: not-affected
impish_edk2: not-affected
jammy_edk2: not-affected
kinetic_edk2: not-affected
devel_edk2: not-affected
