Candidate: CVE-2023-30571
PublicDate: 2023-05-29 20:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30571
Description:
 Libarchive through 3.6.2 can cause directories to have world-writable
 permissions. The umask() call inside archive_write_disk_posix.c changes the
 umask of the whole process for a very short period of time; a race
 condition with another thread can lead to a permanent umask 0 setting. Such
 a race condition could lead to implicit directory creation with permissions
 0777 (without the sticky bit), which means that any low-privileged local
 user can delete and rename files inside those directories.
Ubuntu-Description:
Notes:
 mdeslaur> as of 2023-06-05, there is no patch available from the upstream
 mdeslaur> libarchive project. Marking as deferred.
Mitigation:
Bugs:
 https://github.com/libarchive/libarchive/issues/1876
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H [5.3 MEDIUM]

Patches_libarchive:
upstream_libarchive: needs-triage
trusty_libarchive: ignored (end of standard support)
trusty/esm_libarchive: deferred (2023-06-05)
xenial_libarchive: ignored (end of standard support)
esm-infra/xenial_libarchive: deferred (2023-06-05)
bionic_libarchive: ignored (end of standard support, was needs-triage)
esm-infra/bionic_libarchive: deferred (2023-06-05)
focal_libarchive: deferred (2023-06-05)
jammy_libarchive: deferred (2023-06-05)
kinetic_libarchive: deferred (2023-06-05)
lunar_libarchive: deferred (2023-06-05)
devel_libarchive: deferred (2023-06-05)
