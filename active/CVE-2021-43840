Candidate: CVE-2021-43840
PublicDate: 2021-12-17 19:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43840
 https://github.com/discourse/message_bus/security/advisories/GHSA-xmgj-5fh3-xjmm
 https://github.com/discourse/message_bus/commit/9b6deee01ed474c7e9b5ff65a06bb0447b4db2ba
Description:
 message_bus is a messaging bus for Ruby processes and web clients. In
 versions prior to 3.3.7 users who deployed message bus with diagnostics
 features enabled (default off) are vulnerable to a path traversal bug,
 which could lead to disclosure of secret information on a machine if an
 unintended user were to gain access to the diagnostic route. The impact is
 also greater if there is no proxy for your web application as the number of
 steps up the directories is not bounded. For deployments which uses a
 proxy, the impact varies. For example, If a request goes through a proxy
 like Nginx with `merge_slashes` enabled, the number of steps up the
 directories that can be read is limited to 3 levels. This issue has been
 patched in version 3.3.7. Users unable to upgrade should ensure that
 MessageBus::Diagnostics is disabled.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N

Patches_ruby1.9.1:
upstream_ruby1.9.1: needs-triage
trusty_ruby1.9.1: ignored (out of standard support)
trusty/esm_ruby1.9.1: DNE
xenial_ruby1.9.1: DNE
bionic_ruby1.9.1: DNE
focal_ruby1.9.1: DNE
hirsute_ruby1.9.1: DNE
impish_ruby1.9.1: DNE
devel_ruby1.9.1: DNE

Patches_ruby2.0:
upstream_ruby2.0: needs-triage
trusty_ruby2.0: ignored (out of standard support)
trusty/esm_ruby2.0: DNE
xenial_ruby2.0: DNE
bionic_ruby2.0: DNE
focal_ruby2.0: DNE
hirsute_ruby2.0: DNE
impish_ruby2.0: DNE
devel_ruby2.0: DNE

Patches_ruby2.3:
upstream_ruby2.3: needs-triage
trusty_ruby2.3: DNE
trusty/esm_ruby2.3: DNE
xenial_ruby2.3: needs-triage
esm-infra/xenial_ruby2.3: needs-triage
bionic_ruby2.3: DNE
focal_ruby2.3: DNE
hirsute_ruby2.3: DNE
impish_ruby2.3: DNE
devel_ruby2.3: DNE

Patches_ruby2.5:
upstream_ruby2.5: needs-triage
trusty_ruby2.5: DNE
trusty/esm_ruby2.5: DNE
xenial_ruby2.5: DNE
bionic_ruby2.5: needs-triage
focal_ruby2.5: DNE
hirsute_ruby2.5: DNE
impish_ruby2.5: DNE
devel_ruby2.5: DNE

Patches_ruby2.7:
upstream_ruby2.7: needs-triage
trusty_ruby2.7: DNE
trusty/esm_ruby2.7: DNE
xenial_ruby2.7: DNE
bionic_ruby2.7: DNE
focal_ruby2.7: needs-triage
hirsute_ruby2.7: needs-triage
impish_ruby2.7: needs-triage
devel_ruby2.7: needs-triage
