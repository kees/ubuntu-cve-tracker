Candidate: CVE-2023-40547
PublicDate: 2024-01-23
CRD: 2024-01-23
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40547
 https://bugs.launchpad.net/ubuntu/+source/shim-signed/+bug/2051151
Description:
 [avoid incorrectly trusting HTTP headers
 When retrieving files via HTTP or related protocols, shim attempts to
 allocate a buffer to store the received data.  Unfortunately, this means
 getting the size from an HTTP header, which can be manipulated to
 specify a size that's smaller than the received data.  In this case, the
 code accidentally uses the header for the allocation but the protocol
 metadata to copy it from the rx buffer, resulting in an out-of-bounds
 write.
 This patch adds an additional check to test that the rx buffer is not
 larger than the allocation.]
Ubuntu-Description:
Notes:
 eslerm> secureboot-db should only ever be updated after shim
 eslerm> secureboot-db is not updated on ESM releases as doing so would
 eslerm> revoke install media keys Note that key revocation is required to
 eslerm> protect against evil housekeeper attacks (such as BlackLotus)
Mitigation:
Bugs:
Priority: medium
Discovered-by: Bill Demirkapi
Assigned-to:
CVSS:
 other: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H [9.0 CRITICAL]

Patches_secureboot-db:
upstream_secureboot-db: needs-triage
trusty_secureboot-db: ignored (end of standard support)
trusty/esm_secureboot-db: needs-triage
xenial_secureboot-db: ignored (end of standard support)
esm-infra/xenial_secureboot-db: needs-triage
bionic_secureboot-db: ignored (end of standard support)
esm-infra/bionic_secureboot-db: needs-triage
focal_secureboot-db: needs-triage
jammy_secureboot-db: needs-triage
lunar_secureboot-db: needs-triage
mantic_secureboot-db: needs-triage
devel_secureboot-db: needs-triage

Patches_shim-signed:
upstream_shim-signed: needs-triage
trusty_shim-signed: ignored (end of standard support)
trusty/esm_shim-signed: ignored (install media keys will never be revoked)
xenial_shim-signed: ignored (end of standard support)
esm-infra/xenial_shim-signed: ignored (install media keys will never be revoked)
bionic_shim-signed: ignored (end of standard support)
esm-infra/bionic_shim-signed: needs-triage
focal_shim-signed: needs-triage
jammy_shim-signed: needs-triage
lunar_shim-signed: needs-triage
mantic_shim-signed: needs-triage
devel_shim-signed: needs-triage

Patches_shim:
 upstream: https://github.com/rhboot/shim/commit/0226b56513b2b8bd5fd281bce77c40c9bf07c66d (15.8)
upstream_shim: needs-triage
trusty_shim: ignored (end of standard support)
trusty/esm_shim: ignored (install media keys will never be revoked)
xenial_shim: ignored (end of standard support)
esm-infra/xenial_shim: ignored (install media keys will never be revoked)
bionic_shim: ignored (end of standard support)
esm-infra/bionic_shim: needs-triage
focal_shim: needs-triage
jammy_shim: needs-triage
lunar_shim: needs-triage
mantic_shim: needs-triage
devel_shim: needs-triage
