Candidate: CVE-2023-40548
PublicDate: 2024-01-23
CRD: 2024-01-23
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40548
Description:
 [Fix integer overflow on SBAT section size on 32-bit system
 In verify_sbat_section(), we do some math on data that comes from the
 binary being verified - in this case, we add 1 to the size of the
 ".sbat" section as reported in the section header, which is then used as
 the input to the size of an allocation.  The original value is then used
 for a size in a memcpy(), which means there's an out-of-bounds write in
 the overflow case.
 Due to the type of the variable being size_t, but the type in the
 section header being uint32_t, this is only plausibly accomplished on
 32-bit systems.
 This patch makes the arithmetic use a checked add operation to avoid
 overflow.  Additionally, it adds a check in verify_buffer_sbat() to
 guarantee that the data is within the binary.
 It's not currently known if this is actually exploitable on such
 systems; the memory layout on a particular machine may further mitigate
 this scenario.]
Ubuntu-Description:
Notes:
 eslerm> secureboot-db should only ever be updated after shim
 eslerm> secureboot-db is not updated on ESM releases as doing so would
 eslerm> revoke install media keys Note that key revocation is required to
 eslerm> protect against evil housekeeper attacks (such as BlackLotus)
Mitigation:
Bugs:
Priority: medium
Discovered-by: Greg Kirkpatrick
Assigned-to:
CVSS:

Patches_secureboot-db:
upstream_secureboot-db: needs-triage
trusty_secureboot-db: ignored (end of standard support)
trusty/esm_secureboot-db: needs-triage
xenial_secureboot-db: ignored (end of standard support)
esm-infra/xenial_secureboot-db: needs-triage
bionic_secureboot-db: ignored (end of standard support)
esm-infra/bionic_secureboot-db: needs-triage
focal_secureboot-db: needs-triage
jammy_secureboot-db: needs-triage
lunar_secureboot-db: needs-triage
mantic_secureboot-db: needs-triage
devel_secureboot-db: needs-triage

Patches_shim-signed:
upstream_shim-signed: needs-triage
trusty_shim-signed: ignored (end of standard support)
trusty/esm_shim-signed: ignored (install media keys will never be revoked)
xenial_shim-signed: ignored (end of standard support)
esm-infra/xenial_shim-signed: ignored (install media keys will never be revoked)
bionic_shim-signed: ignored (end of standard support)
esm-infra/bionic_shim-signed: needs-triage
focal_shim-signed: needs-triage
jammy_shim-signed: needs-triage
lunar_shim-signed: needs-triage
mantic_shim-signed: needs-triage
devel_shim-signed: needs-triage

Patches_shim:
 upstream: https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)
upstream_shim: needs-triage
trusty_shim: ignored (end of standard support)
trusty/esm_shim: ignored (install media keys will never be revoked)
xenial_shim: ignored (end of standard support)
esm-infra/xenial_shim: ignored (install media keys will never be revoked)
bionic_shim: ignored (end of standard support)
esm-infra/bionic_shim: needs-triage
focal_shim: needs-triage
jammy_shim: needs-triage
lunar_shim: needs-triage
mantic_shim: needs-triage
devel_shim: needs-triage
