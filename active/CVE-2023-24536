Candidate: CVE-2023-24536
PublicDate: 2023-04-06 16:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-24536
 https://groups.google.com/g/golang-announce/c/Xdv6JL9ENs8
 https://go.dev/issue/59153
 https://github.com/golang/go/commit/bf8c7c575c8a552d9d79deb29e80854dc88528d0 (go1.20.3)
 https://github.com/golang/go/commit/7917b5f31204528ea72e0629f0b7d52b35b27538 (go.1.19.8)
Description:
 Multipart form parsing can consume large amounts of CPU and memory when
 processing form inputs containing very large numbers of parts. This stems
 from several causes: 1. mime/multipart.Reader.ReadForm limits the total
 memory a parsed multipart form can consume. ReadForm can undercount the
 amount of memory consumed, leading it to accept larger inputs than
 intended. 2. Limiting total memory does not account for increased pressure
 on the garbage collector from large numbers of small allocations in forms
 with many parts. 3. ReadForm can allocate a large number of short-lived
 buffers, further increasing pressure on the garbage collector. The
 combination of these factors can permit an attacker to cause an program
 that parses multipart forms to consume large amounts of CPU and memory,
 potentially resulting in a denial of service. This affects programs that
 use mime/multipart.Reader.ReadForm, as well as form parsing in the net/http
 package with the Request methods FormFile, FormValue, ParseMultipartForm,
 and PostFormValue. With fix, ReadForm now does a better job of estimating
 the memory consumption of parsed forms, and performs many fewer short-lived
 allocations. In addition, the fixed mime/multipart.Reader imposes the
 following limits on the size of parsed forms: 1. Forms parsed with ReadForm
 may contain no more than 1000 parts. This limit may be adjusted with the
 environment variable GODEBUG=multipartmaxparts=. 2. Form parts parsed with
 NextPart and NextRawPart may contain no more than 10,000 header fields. In
 addition, forms parsed with ReadForm may contain no more than 10,000 header
 fields across all parts. This limit may be adjusted with the environment
 variable GODEBUG=multipartmaxheaders=.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: 0xnishit
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_golang-1.6:
upstream_golang-1.6: needs-triage
trusty_golang-1.6: ignored (out of standard support)
xenial_golang-1.6: ignored (out of standard support)
esm-infra/xenial_golang-1.6: needed
bionic_golang-1.6: DNE
focal_golang-1.6: DNE
jammy_golang-1.6: DNE
kinetic_golang-1.6: DNE
devel_golang-1.6: DNE

Patches_golang-1.8:
upstream_golang-1.8: needs-triage
trusty_golang-1.8: ignored (out of standard support)
xenial_golang-1.8: ignored (out of standard support)
bionic_golang-1.8: needed
esm-apps/bionic_golang-1.8: needed
focal_golang-1.8: DNE
jammy_golang-1.8: DNE
kinetic_golang-1.8: DNE
devel_golang-1.8: DNE

Patches_golang-1.9:
upstream_golang-1.9: needs-triage
trusty_golang-1.9: ignored (out of standard support)
xenial_golang-1.9: ignored (out of standard support)
bionic_golang-1.9: needed
esm-apps/bionic_golang-1.9: needed
focal_golang-1.9: DNE
jammy_golang-1.9: DNE
kinetic_golang-1.9: DNE
devel_golang-1.9: DNE

Patches_golang-1.10:
upstream_golang-1.10: needs-triage
trusty_golang-1.10: ignored (out of standard support)
trusty/esm_golang-1.10: needed
xenial_golang-1.10: ignored (out of standard support)
esm-infra/xenial_golang-1.10: needed
bionic_golang-1.10: needed
focal_golang-1.10: DNE
jammy_golang-1.10: DNE
kinetic_golang-1.10: DNE
devel_golang-1.10: DNE

Patches_golang-1.13:
upstream_golang-1.13: needs-triage
trusty_golang-1.13: ignored (out of standard support)
xenial_golang-1.13: ignored (out of standard support)
esm-apps/xenial_golang-1.13: needed
bionic_golang-1.13: needed
esm-apps/bionic_golang-1.13: needed
focal_golang-1.13: needed
jammy_golang-1.13: needed
esm-apps/jammy_golang-1.13: needed
kinetic_golang-1.13: needed
devel_golang-1.13: DNE

Patches_golang-1.14:
upstream_golang-1.14: needed
trusty_golang-1.14: ignored (out of standard support)
xenial_golang-1.14: ignored (out of standard support)
bionic_golang-1.14: DNE
focal_golang-1.14: needed
jammy_golang-1.14: DNE
kinetic_golang-1.14: DNE
devel_golang-1.14: DNE

Patches_golang-1.16:
upstream_golang-1.16: needs-triage
trusty_golang-1.16: ignored (out of standard support)
xenial_golang-1.16: ignored (out of standard support)
bionic_golang-1.16: needed
focal_golang-1.16: needed
esm-apps/focal_golang-1.16: needed
jammy_golang-1.16: DNE
kinetic_golang-1.16: DNE
devel_golang-1.16: DNE

Patches_golang-1.17:
upstream_golang-1.17: needs-triage
trusty_golang-1.17: ignored (out of standard support)
xenial_golang-1.17: ignored (out of standard support)
bionic_golang-1.17: DNE
focal_golang-1.17: DNE
jammy_golang-1.17: needed
kinetic_golang-1.17: DNE
devel_golang-1.17: DNE

Patches_golang-1.18:
upstream_golang-1.18: needs-triage
trusty_golang-1.18: ignored (out of standard support)
xenial_golang-1.18: ignored (out of standard support)
bionic_golang-1.18: needed
focal_golang-1.18: needed
jammy_golang-1.18: needed
kinetic_golang-1.18: DNE
devel_golang-1.18: DNE

Patches_golang-1.19:
 upstream: https://github.com/golang/go/commit/7917b5f31204528ea72e0629f0b7d52b35b27538
upstream_golang-1.19: released (1.19.8-1)
trusty_golang-1.19: ignored (out of standard support)
xenial_golang-1.19: ignored (out of standard support)
bionic_golang-1.19: DNE
focal_golang-1.19: DNE
jammy_golang-1.19: DNE
kinetic_golang-1.19: needed
devel_golang-1.19: not-affected (1.19.8-1)

Patches_golang-1.20:
 upstream: https://github.com/golang/go/commit/bf8c7c575c8a552d9d79deb29e80854dc88528d0
upstream_golang-1.20: released (1.20.3-1)
trusty_golang-1.20: ignored (out of standard support)
xenial_golang-1.20: ignored (out of standard support)
bionic_golang-1.20: DNE
focal_golang-1.20: DNE
jammy_golang-1.20: DNE
kinetic_golang-1.20: DNE
devel_golang-1.20: not-affected (1.20.3-1)
