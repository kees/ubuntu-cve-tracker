Candidate: CVE-2022-29154
PublicDate: 2022-08-02 15:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29154
 https://download.samba.org/pub/rsync/NEWS
 https://lists.samba.org/archive/rsync/2022-August/032860.html
Description:
 An issue was discovered in rsync before 3.2.5 that allows malicious remote
 servers to write arbitrary files inside the directories of connecting
 peers. The server chooses which files/directories are sent to the client.
 However, the rsync client performs insufficient validation of file names. A
 malicious rsync server (or Man-in-The-Middle attacker) can overwrite
 arbitrary files in the rsync client target directory and subdirectories
 (for example, overwrite the .ssh/authorized_keys file).
Ubuntu-Description: 
Notes: 
 mdeslaur> two additional commits were added later on...need to check if
 mdeslaur> more go in before the official release
 rodrigo-zaiden> Another commit was found to be part of the collection for
 rodrigo-zaiden> this CVE. 4 in total seems to address it. The missing commit
 rodrigo-zaiden> was added in historical order in the Patches section here.
 eslerm> v3.2.3 and earlier require invasive backporting and argument syntax
 eslerm> change to path.
Mitigation: 
Bugs: 
Priority: medium
Discovered-by: Koen van Hove
Assigned-to: eslerm
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:H [7.4 HIGH]


Patches_rsync:
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=b7231c7d02cfb65d291af74ff66e7d8c507ee871
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=7e5424b806e8eea053016268ad186276e9083b77
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=3d7015afa223494e3318495c2f5de9cb49229da9
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=2f7c583143bc6e80902139c23d9d7283f88fbc6a
upstream_rsync: released (3.2.5)
trusty_rsync: ignored (out of standard support)
trusty/esm_rsync: ignored (change too intrusive)
xenial_rsync: ignored (out of standard support)
esm-infra/xenial_rsync: ignored (change too intrusive)
bionic_rsync: ignored (change too intrusive)
focal_rsync: ignored (change too intrusive)
jammy_rsync: ignored (change too intrusive)
devel_rsync: not-affected (3.2.5)
