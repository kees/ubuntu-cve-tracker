Candidate: CVE-2022-41678
PublicDate: 2023-11-28 16:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41678
 https://lists.apache.org/thread/7g17kwbtjl011mm4tr8bn1vnoq9wh4sl
 https://activemq.apache.org/security-advisories.data/CVE-2022-41678-announcement.txt
Description:
 Once an user is authenticated on Jolokia, he can potentially trigger
 arbitrary code execution. In details, in ActiveMQ configurations, jetty
 allows org.jolokia.http.AgentServlet to handler request to /api/jolokia
 org.jolokia.http.HttpRequestHandler#handlePostRequest is able to create
 JmxRequest through JSONObject. And calls to
 org.jolokia.http.HttpRequestHandler#executeRequest. Into deeper calling
 stacks, org.jolokia.handler.ExecHandler#doHandleRequest is able to invoke
 through refection. And then, RCE is able to be achieved via
 jdk.management.jfr.FlightRecorderMXBeanImpl which exists on Java version
 above 11. 1 Call newRecording. 2 Call setConfiguration. And a webshell data
 hides in it. 3 Call startRecording. 4 Call copyTo method. The webshell will
 be written to a .jsp file. The mitigation is to restrict (by default) the
 actions authorized on Jolokia, or disable Jolokia. A more restrictive
 Jolokia configuration has been defined in default ActiveMQ distribution. We
 encourage users to upgrade to ActiveMQ distributions version including
 updated Jolokia configuration: 5.16.6, 5.17.4, 5.18.0, 6.0.0.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]

Patches_activemq:
upstream_activemq: released (5.17.6+dfsg-1)
trusty_activemq: ignored (end of standard support)
xenial_activemq: ignored (end of standard support)
esm-apps/xenial_activemq: needs-triage
bionic_activemq: ignored (end of standard support)
esm-apps/bionic_activemq: needs-triage
focal_activemq: needs-triage
esm-apps/focal_activemq: needs-triage
jammy_activemq: needs-triage
esm-apps/jammy_activemq: needs-triage
lunar_activemq: needs-triage
mantic_activemq: needs-triage
devel_activemq: not-affected (5.17.6+dfsg-1)
