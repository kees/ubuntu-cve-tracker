Candidate: CVE-2023-22745
PublicDate: 2023-01-19 23:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-22745
 https://github.com/tpm2-software/tpm2-tss/security/advisories/GHSA-4j3v-fh23-vx67
Description:
 tpm2-tss is an open source software implementation of the Trusted Computing
 Group (TCG) Trusted Platform Module (TPM) 2 Software Stack (TSS2). In
 affected versions `Tss2_RC_SetHandler` and `Tss2_RC_Decode` both index into
 `layer_handler` with an 8 bit layer number, but the array only has
 `TPM2_ERROR_TSS2_RC_LAYER_COUNT` entries, so trying to add a handler for
 higher-numbered layers or decode a response code with such a layer number
 reads/writes past the end of the buffer. This Buffer overrun, could result
 in arbitrary code execution. An example attack would be a MiTM bus attack
 that returns 0xFFFFFFFF for the RC. Given the common use case of TPM
 modules an attacker must have local access to the target machine with local
 system privileges which allows access to the TPM system. Usually TPM access
 requires administrative privilege.
Ubuntu-Description:
Notes:
 mdeslaur> accessing the TPM requires administrative privileges, so this
 mdeslaur> is an unimportant attack scenario, setting priority to low
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H [6.4 MEDIUM]

Patches_tpm2-tss:
 upstream: https://github.com/tpm2-software/tpm2-tss/commit/306490c8d848c367faa2d9df81f5e69dab46ffb5
upstream_tpm2-tss: released (3.2.1-3)
trusty_tpm2-tss: ignored (out of standard support)
xenial_tpm2-tss: ignored (out of standard support)
esm-apps/xenial_tpm2-tss: needs-triage
bionic_tpm2-tss: needed
esm-apps/bionic_tpm2-tss: needs-triage
focal_tpm2-tss: needed
jammy_tpm2-tss: needed
kinetic_tpm2-tss: needed
devel_tpm2-tss: not-affected (3.2.1-3ubuntu1)
