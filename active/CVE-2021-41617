PublicDateAtUSN: 2021-09-26 19:15:00 UTC
Candidate: CVE-2021-41617
PublicDate: 2021-09-26 19:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41617
 https://www.openwall.com/lists/oss-security/2021/09/26/1
 https://www.openssh.com/txt/release-8.8
 https://www.openssh.com/security.html
 https://ubuntu.com/security/notices/USN-5666-1
Description:
 sshd in OpenSSH 6.2 through 8.x before 8.8, when certain non-default
 configurations are used, allows privilege escalation because supplemental
 groups are not initialized as expected. Helper programs for
 AuthorizedKeysCommand and AuthorizedPrincipalsCommand may run with
 privileges associated with group memberships of the sshd process, if the
 configuration specifies running the command as a different user.
Ubuntu-Description:
Notes:
 seth-arnold> openssh-ssh1 is provided for compatibility with old devices that
  cannot be upgraded to modern protocols. Thus we may not provide security
  support for this package if doing so would prevent access to equipment.
 mdeslaur> Only applies to non-default configurations where
 mdeslaur> AuthorizedKeysCommand or AuthorizedPrincipalsCommand are used.
 sespiros> Cannot reproduce since sshd for all releases drops supplementary
 sespiros> groups early when it starts with setgroups(0, NULL).
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=995130
 https://bugzilla.suse.com/show_bug.cgi?id=1190975
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H [7.0 HIGH]

Patches_openssh:
 upstream: https://github.com/openssh/openssh-portable/commit/f3cbe43e28fe71427d41cfe3a17125b972710455
 upstream: https://github.com/openssh/openssh-portable/commit/bf944e3794eff5413f2df1ef37cddf96918c6bde
upstream_openssh: released (8.8)
trusty_openssh: ignored (out of standard support)
trusty/esm_openssh: needed
xenial_openssh: ignored (end of standard support, was needed)
esm-infra/xenial_openssh: released (1:7.2p2-4ubuntu2.10+esm2)
fips/xenial_openssh: needed
fips-updates/xenial_openssh: needed
bionic_openssh: needed
fips/bionic_openssh: needed
fips-updates/bionic_openssh: needed
focal_openssh: needed
fips/focal_openssh: needed
fips-updates/focal_openssh: needed
hirsute_openssh: ignored (reached end-of-life)
impish_openssh: ignored (reached end-of-life)
jammy_openssh: needed
kinetic_openssh: needed
devel_openssh: not-affected (1:9.0p1-1ubuntu7)

Patches_openssh-ssh1:
upstream_openssh-ssh1: ignored (frozen on openssh 7.5p)
trusty_openssh-ssh1: DNE
trusty/esm_openssh-ssh1: DNE
xenial_openssh-ssh1: DNE
bionic_openssh-ssh1: needed
esm-apps/bionic_openssh-ssh1: needed
focal_openssh-ssh1: needed
esm-apps/focal_openssh-ssh1: needed
hirsute_openssh-ssh1: ignored (reached end-of-life)
impish_openssh-ssh1: ignored (reached end-of-life)
jammy_openssh-ssh1: needed
esm-apps/jammy_openssh-ssh1: needed
kinetic_openssh-ssh1: needed
devel_openssh-ssh1: needed
