PublicDateAtUSN: 2023-12-18 15:00:00 UTC
Candidate: CVE-2023-48795
PublicDate: 2023-12-18 15:00:00 UTC
CRD: 2023-12-18 15:00:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-48795
 https://terrapin-attack.com/
 https://www.openwall.com/lists/oss-security/2023/12/18/3
 https://github.com/ronf/asyncssh/security/advisories/GHSA-hfmc-7525-mj55
 https://ubuntu.com/security/notices/USN-6560-1
 https://ubuntu.com/security/notices/USN-6561-1
 https://ubuntu.com/security/notices/USN-6560-2
Description:
 Prefix truncation attack on BPP: By manipulating sequence numbers during
 the handshake, an attacker can remove the initial messages on the secure
 channel without causing a MAC failure.
Ubuntu-Description:
Notes:
 mdeslaur> Per upstream openssh developers:
  While cryptographically novel, the security impact of this attack
  is fortunately very limited as it only allows deletion of
  consecutive messages, and deleting most messages at this stage of
  the protocol prevents user user authentication from proceeding and
  results in a stuck connection.
  The most serious identified impact is that it lets a MITM to
  delete the SSH2_MSG_EXT_INFO message sent before authentication
  starts, allowing the attacker to disable a subset of the keystroke
  timing obfuscation features introduced in OpenSSH 9.5. There is no
  other discernable impact to session secrecy or session integrity.
 sbeattie> putty fixes include some refactoring commits that are used
  by the added strict kex mode support
 seth-arnold> openssh-ssh1 is provided for compatibility with old devices
 seth-arnold> that cannot be upgraded to modern protocols. Thus we may not
 seth-arnold> provide security support for this package if doing so would
 seth-arnold> prevent access to equipment.
 jdstrand> snapd contains an embedded copy of golang-go.crypto
 jdstrand> lxd in 18.04 LTS and earlier contains an embedded copy of
 jdstrand> golang-go.crypto
 sbeattie> proftpd-dfsg contains an ssh implementation in mod-sftp
  (distributed in proftpd-mod-crypto/proftpd-basic)
 mdeslaur> per Debian, libssh2 older than mantic isn't vulnerable as it
 mdeslaur> doesn't support ChaCha20-Poly1305 and CBC-EtM.
Mitigation:
Bugs:
 https://github.com/golang/go/issues/64784
 https://github.com/paramiko/paramiko/issues/2337
 https://github.com/libssh2/libssh2/issues/1290
Priority: medium
Discovered-by: Fabian Bäumer, Marcus Brinkmann, Jörg Schwenk
Assigned-to: mdeslaur(libssh2,paramiko)
CVSS:
 other: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N [5.9 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N [5.9 MEDIUM]

Patches_openssh:
 upstream: https://github.com/openssh/openssh-portable/commit/1edb00c58f8a6875fad6a497aa2bacf37f9e6cd5
upstream_openssh: released (1:9.5p1-1)
trusty_openssh: ignored (end of standard support)
trusty/esm_openssh: needs-triage
xenial_openssh: ignored (end of standard support)
esm-infra/xenial_openssh: released (1:7.2p2-4ubuntu2.10+esm5)
fips-updates/xenial_openssh: needs-triage
fips/xenial_openssh: needs-triage
bionic_openssh: ignored (end of standard support)
esm-infra/bionic_openssh: released (1:7.6p1-4ubuntu0.7+esm3)
fips-updates/bionic_openssh: needs-triage
fips/bionic_openssh: needs-triage
focal_openssh: released (1:8.2p1-4ubuntu0.10)
fips-updates/focal_openssh: needs-triage
fips/focal_openssh: needs-triage
jammy_openssh: released (1:8.9p1-3ubuntu0.5)
lunar_openssh: released (1:9.0p1-1ubuntu8.6)
mantic_openssh: released (1:9.3p1-1ubuntu3.1)
devel_openssh: needs-triage

Patches_dropbear:
 upstream: https://github.com/mkj/dropbear/commit/6e43be5c7b99dbee49dc72b6f989f29fdd7e9356
upstream_dropbear: needs-triage
trusty_dropbear: ignored (end of standard support)
xenial_dropbear: ignored (end of standard support)
esm-apps/xenial_dropbear: needs-triage
bionic_dropbear: ignored (end of standard support)
esm-apps/bionic_dropbear: needs-triage
focal_dropbear: needs-triage
esm-apps/focal_dropbear: needs-triage
jammy_dropbear: needs-triage
esm-apps/jammy_dropbear: needs-triage
lunar_dropbear: needs-triage
mantic_dropbear: needs-triage
devel_dropbear: needs-triage

Patches_golang-go.crypto:
 upstream: https://github.com/golang/crypto/commit/9d2ee975ef9fe627bf0a6f01c1f69e8ef1d4f05d
upstream_golang-go.crypto: needs-triage
trusty_golang-go.crypto: ignored (end of standard support)
xenial_golang-go.crypto: ignored (end of standard support)
esm-infra/xenial_golang-go.crypto: needs-triage
bionic_golang-go.crypto: ignored (end of standard support)
esm-apps/bionic_golang-go.crypto: needs-triage
focal_golang-go.crypto: needs-triage
esm-apps/focal_golang-go.crypto: needs-triage
jammy_golang-go.crypto: needs-triage
esm-apps/jammy_golang-go.crypto: needs-triage
lunar_golang-go.crypto: needs-triage
mantic_golang-go.crypto: needs-triage
devel_golang-go.crypto: needs-triage

Patches_snapd:
upstream_snapd: needs-triage
snap_snapd: needs-triage
trusty_snapd: ignored (end of standard support)
xenial_snapd: ignored (end of standard support)
esm-infra/xenial_snapd: needs-triage
bionic_snapd: ignored (end of standard support)
esm-infra/bionic_snapd: needs-triage
focal_snapd: needs-triage
jammy_snapd: needs-triage
lunar_snapd: needs-triage
mantic_snapd: needs-triage
devel_snapd: needs-triage

Patches_lxd:
upstream_lxd: needs-triage
trusty_lxd: DNE
xenial_lxd: ignored (end of standard support)
esm-infra/xenial_lxd: needs-triage
bionic_lxd: ignored (end of standard support)
esm-infra/bionic_lxd: needs-triage
focal_lxd: not-affected (code-not-present)
esm-apps/focal_lxd: needs-triage
jammy_lxd: DNE
lunar_lxd: DNE
mantic_lxd: DNE
devel_lxd: DNE

Patches_libssh:
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/4cef5e965a46e9271aed62631b152e4bd23c1e3c
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/0870c8db28be9eb457ee3d4f9a168959d9507efd
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/5846e57538c750c5ce67df887d09fa99861c79c6
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/89df759200d31fc79fbbe213d8eda0d329eebf6d
upstream_libssh: released (0.10.6-1)
trusty_libssh: ignored (end of standard support)
xenial_libssh: ignored (end of standard support)
esm-infra/xenial_libssh: needs-triage
bionic_libssh: ignored (end of standard support)
esm-infra/bionic_libssh: needs-triage
focal_libssh: released (0.9.3-2ubuntu2.4)
jammy_libssh: released (0.9.6-2ubuntu0.22.04.2)
lunar_libssh: released (0.10.4-2ubuntu0.2)
mantic_libssh: released (0.10.5-3ubuntu1.1)
devel_libssh: not-affected (0.10.6-2)

Patches_libssh2:
 upstream: https://github.com/libssh2/libssh2/commit/d34d9258b8420b19ec3f97b4cc5bf7aa7d98e35a
 upstream: https://github.com/libssh2/libssh2/pull/1291
upstream_libssh2: released (1.11.0-4)
trusty_libssh2: ignored (end of standard support)
trusty/esm_libssh2: not-affected
xenial_libssh2: ignored (end of standard support)
esm-apps/xenial_libssh2: not-affected
bionic_libssh2: ignored (end of standard support)
esm-apps/bionic_libssh2: not-affected
focal_libssh2: not-affected (1.8.0-2.1ubuntu0.1)
esm-apps/focal_libssh2: not-affected (1.8.0-2.1ubuntu0.1)
jammy_libssh2: not-affected (1.10.0-3)
esm-apps/jammy_libssh2: not-affected (1.10.0-3)
lunar_libssh2: not-affected (1.10.0-3)
mantic_libssh2: needed
devel_libssh2: not-affected (1.11.0-4)

Patches_openssh-ssh1:
upstream_openssh-ssh1: ignored (frozen on openssh 7.5p)
trusty_openssh-ssh1: DNE
xenial_openssh-ssh1: DNE
bionic_openssh-ssh1: ignored (end of standard support)
esm-apps/bionic_openssh-ssh1: needs-triage
focal_openssh-ssh1: needs-triage
esm-apps/focal_openssh-ssh1: needs-triage
jammy_openssh-ssh1: needs-triage
esm-apps/jammy_openssh-ssh1: needs-triage
lunar_openssh-ssh1: needs-triage
mantic_openssh-ssh1: needs-triage
devel_openssh-ssh1: needs-triage

Patches_paramiko:
 upstream: https://github.com/paramiko/paramiko/commit/be3ffc18cc466e0b0a877d716721353c12561bcc
 upstream: https://github.com/paramiko/paramiko/commit/4c7f0410c533cdf0df2890512237961f934f5ab9 (changelog)
 upstream: https://github.com/paramiko/paramiko/commit/773a174fb1e40e1d18dbe2625e16337ea401119e
 upstream: https://github.com/paramiko/paramiko/commit/c32be441a5ff0dc4914b22d6d1efa392aebe862f (not required)
 upstream: https://github.com/paramiko/paramiko/commit/f4dedacb9040d27d9844f51c81c28e0247d3e4a3
 upstream: https://github.com/paramiko/paramiko/commit/73f079f5a4bbba7f3048dadbe05b24242206745e (changelog)
 upstream: https://github.com/paramiko/paramiko/commit/75e311d3c0845a316b6e7b3fae2488d86ad5a270
 upstream: https://github.com/paramiko/paramiko/commit/fa46de7feeeb8a01dc471581a0258252ce4f2db6
 upstream: https://github.com/paramiko/paramiko/commit/8dcb237f0ee095b1d8b26765c3d41d0ab6963be9 (test suite fix)
 upstream: https://github.com/paramiko/paramiko/commit/58785d29c47570fa700e096d16b9a0d3a6069048 (changelog)
 upstream: https://github.com/paramiko/paramiko/commit/96db1e2be856eac66631761bae41167a1ebd2b4e
 upstream: https://github.com/paramiko/paramiko/commit/33508c920309860c4a775be70f209c2a400e18ec
 upstream: https://github.com/paramiko/paramiko/commit/30b447b911c39460bbef5e7834e339c43a251316 (lint)
 upstream: https://github.com/paramiko/paramiko/commit/3e4bdf998f5b1508322234a527e8fa432220368b (changelog)
upstream_paramiko: needs-triage
trusty_paramiko: ignored (end of standard support)
trusty/esm_paramiko: needs-triage
xenial_paramiko: ignored (end of standard support)
esm-infra/xenial_paramiko: needs-triage
bionic_paramiko: ignored (end of standard support)
esm-infra/bionic_paramiko: needs-triage
focal_paramiko: needs-triage
jammy_paramiko: needs-triage
lunar_paramiko: needs-triage
mantic_paramiko: needs-triage
devel_paramiko: needs-triage

Patches_putty:
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=9e099151574885f3c717ac10a633a9218db8e7bb
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=f2e7086902b3605c96e54ef9c956ca7ab000010e
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=9fcbb86f715bc03e58921482efe663aa0c662d62
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=244be5412728a7334a2d457fbac4e0a2597165e5
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=58fc33a155ad496bdcf380fa6193302240a15ae9
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=0b00e4ce26d89cd010e31e66fd02ac77cb982367
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=fdc891d17063ab26cf68c74245ab1fd9771556cb
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=b80a41d386dbfa1b095c17bd2ed001477f302d46
upstream_putty: released (0.80-1)
trusty_putty: ignored (end of standard support)
xenial_putty: ignored (end of standard support)
esm-apps/xenial_putty: needs-triage
bionic_putty: ignored (end of standard support)
esm-apps/bionic_putty: needs-triage
focal_putty: needs-triage
esm-apps/focal_putty: needs-triage
jammy_putty: needs-triage
esm-apps/jammy_putty: needs-triage
lunar_putty: needs-triage
mantic_putty: needs-triage
devel_putty: needs-triage

Patches_proftpd-dfsg:
upstream_proftpd-dfsg: needs-triage
trusty_proftpd-dfsg: ignored (end of standard support)
xenial_proftpd-dfsg: ignored (end of standard support)
esm-apps/xenial_proftpd-dfsg: needs-triage
bionic_proftpd-dfsg: ignored (end of standard support)
esm-apps/bionic_proftpd-dfsg: needs-triage
focal_proftpd-dfsg: needs-triage
esm-apps/focal_proftpd-dfsg: needs-triage
jammy_proftpd-dfsg: needs-triage
esm-apps/jammy_proftpd-dfsg: needs-triage
lunar_proftpd-dfsg: needs-triage
mantic_proftpd-dfsg: needs-triage
devel_proftpd-dfsg: needs-triage

Patches_python-asyncssh:
 upstream: https://github.com/ronf/asyncssh/commit/0bc73254f41acb140187e0c89606311f88de5b7b
upstream_python-asyncssh: released (2.14.2)
trusty_python-asyncssh: DNE
xenial_python-asyncssh: ignored (end of standard support)
esm-apps/xenial_python-asyncssh: needs-triage
bionic_python-asyncssh: ignored (end of standard support)
esm-apps/bionic_python-asyncssh: needs-triage
focal_python-asyncssh: needs-triage
esm-apps/focal_python-asyncssh: needs-triage
jammy_python-asyncssh: needs-triage
esm-apps/jammy_python-asyncssh: needs-triage
lunar_python-asyncssh: needs-triage
mantic_python-asyncssh: needs-triage
devel_python-asyncssh: needs-triage
