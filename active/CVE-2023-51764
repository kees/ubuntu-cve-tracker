Candidate: CVE-2023-51764
PublicDate: 2023-12-24 05:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-51764
 https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/
 https://www.openwall.com/lists/oss-security/2023/12/21/6
 https://www.postfix.org/smtp-smuggling.html
 https://www.mail-archive.com/postfix-users@postfix.org/msg100901.html
 https://www.openwall.com/lists/oss-security/2023/12/22/3
Description:
 Postfix through 3.8.4 allows SMTP smuggling unless configured with
 smtpd_data_restrictions=reject_unauth_pipelining and
 smtpd_discard_ehlo_keywords=chunking (or certain other options that exist
 in recent versions). Remote attackers can use a published exploitation
 technique to inject e-mail messages with a spoofed MAIL FROM address,
 allowing bypass of an SPF protection mechanism. This occurs because Postfix
 supports <LF>.<CR><LF> but some other popular e-mail servers do not. To
 prevent attack variants (by always disallowing <LF> without <CR>), a
 different solution is required: the smtpd_forbid_bare_newline=yes option
 with a Postfix minimum version of 3.5.23, 3.6.13, 3.7.9, 3.8.4, or 3.9.
Ubuntu-Description:
Notes:
Mitigation:
 smtpd_forbid_unauth_pipelining = yes
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1059230
 https://bugs.launchpad.net/ubuntu/+source/postfix/+bug/2049337
Priority: medium
Discovered-by:
Assigned-to: allenpthuang
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N [5.3 MEDIUM]

Patches_postfix:
upstream_postfix: released (3.8.4-1)
trusty_postfix: ignored (end of standard support)
trusty/esm_postfix: needs-triage
xenial_postfix: ignored (end of standard support)
esm-infra/xenial_postfix: needs-triage
bionic_postfix: ignored (end of standard support)
esm-infra/bionic_postfix: needs-triage
focal_postfix: needs-triage
jammy_postfix: needs-triage
lunar_postfix: needs-triage
mantic_postfix: needs-triage
devel_postfix: not-affected (3.8.4-1)
