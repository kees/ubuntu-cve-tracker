Candidate: CVE-2023-42464
PublicDate: 2023-09-20 15:15:00 UTC
CRD: 2023-09-16 16:00:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42464
 https://kb.cert.org/vuls/id/408603
 https://github.com/Netatalk/netatalk/releases/tag/netatalk-3-1-17
 https://sourceforge.net/p/netatalk/mailman/message/37896632/
 https://netatalk.sourceforge.io/CVE-2023-42464.php
Description:
 A Type Confusion vulnerability was found in the Spotlight RPC functions in
 afpd in Netatalk 3.1.x before 3.1.17. When parsing Spotlight RPC packets,
 one encoded data structure is a key-value style dictionary where the keys
 are character strings, and the values can be any of the supported types in
 the underlying protocol. Due to a lack of type checking in callers of the
 dalloc_value_for_key() function, which returns the object associated with a
 key, a malicious actor may be able to fully control the value of the
 pointer and theoretically achieve Remote Code Execution on the host. This
 issue is similar to CVE-2023-34967.
Ubuntu-Description:
Notes:
 sbeattie> 2.x versions and older do not support the spotlight
   protocol, support introduced in 3.1.0
 sbeattie> code affected shares origin with samba's mdssvc.c; this
   issue is the netatalk version of the samba CVE-2023-34967
Mitigation:
Bugs:
 https://github.com/Netatalk/netatalk/pull/485
 https://github.com/Netatalk/netatalk/issues/486
Priority: medium
Discovered-by: Florent Saudel and Arnaud Gatignol
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_netatalk:
 upstream: https://github.com/Netatalk/netatalk/commit/a0ee3c246ee9e082436192290610a4d812fc0b7f
upstream_netatalk: released (3.1.17)
trusty_netatalk: not-affected (code not present)
trusty/esm_netatalk: not-affected (code not present)
xenial_netatalk: not-affected (code not present)
esm-apps/xenial_netatalk: not-affected (code not present)
bionic_netatalk: not-affected (code not present)
esm-apps/bionic_netatalk: not-affected (code not present)
focal_netatalk: needed
esm-apps/focal_netatalk: needed
jammy_netatalk: needed
esm-apps/jammy_netatalk: needed
lunar_netatalk: needed
devel_netatalk: needed
