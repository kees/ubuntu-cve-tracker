PublicDateAtUSN: 2022-05-25
Candidate: CVE-2022-1348
CRD: 2022-05-25
PublicDate: 2022-05-25
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1348
 https://github.com/logrotate/logrotate/blame/master/logrotate.c#L3015-L3017
 https://github.com/logrotate/logrotate/commit/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25
 https://ubuntu.com/security/notices/USN-5447-1
Description:
 [the permissions on the logrotate state file are not properly
 restricted. an unprivileged user may cause a denial of service against
 logrotate by locking the state file]
Ubuntu-Description:
Notes:
 amurray| Only affects logrotate >= 3.17.0
 mdeslaur> Ubuntu packages build with:
 mdeslaur> --with-state-file-path=/var/lib/logrotate/status
 mdeslaur> but the /var/lib/logrotate directory itself is 755, so a
 mdeslaur> user can get a lock on the file.
 mdeslaur> See follow-up pull request with additional fix
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: mdeslaur
CVSS:


Patches_logrotate:
 upstream: https://github.com/logrotate/logrotate/commit/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9
 upstream: https://github.com/logrotate/logrotate/pull/446
upstream_logrotate: needs-triage
trusty/esm_logrotate: not-affected (code not present)
esm-infra/xenial_logrotate: not-affected (code not present)
bionic_logrotate: not-affected (code not present)
focal_logrotate: not-affected (code not present)
impish_logrotate: released (3.18.0-2ubuntu1.1)
jammy_logrotate: released (3.19.0-1ubuntu1.1)
devel_logrotate: needed
