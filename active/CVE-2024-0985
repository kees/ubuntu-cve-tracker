Candidate: CVE-2024-0985
PublicDate: 2024-02-09
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-0985
 https://www.postgresql.org/support/security/CVE-2024-0985/
 https://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=d6a61cb3bef3c8fbc35c2a6182e75a8c1d351e41 (REL_16_2)
 https://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=f2fdea198b3d0ab30b9e8478a762488ecebabd88 (REL_15_6)
 https://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=d541ce3b6f0582723150f45d52eab119985d3c19 (REL_13_14)
 https://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=2699fc035a75d0774c1f013e9320882287f78adb (REL_12_18)
Description:
 Late privilege drop in REFRESH MATERIALIZED VIEW CONCURRENTLY in PostgreSQL
 allows an object creator to execute arbitrary SQL functions as the command
 issuer. The command intends to run SQL functions as the owner of the
 materialized view, enabling safe refresh of untrusted materialized views.
 The victim is a superuser or member of one of the attacker's roles. The
 attack requires luring the victim into running REFRESH MATERIALIZED VIEW
 CONCURRENTLY on the attacker's materialized view. As part of exploiting
 this vulnerability, the attacker creates functions that use CREATE RULE to
 convert the internally-built temporary table to a view. Versions before
 PostgreSQL 15.6, 14.11, 13.14, and 12.18 are affected. The only known
 exploit does not work in PostgreSQL 16 and later. For defense in depth,
 PostgreSQL 16.2 adds the protections that older branches are using to fix
 their vulnerability.
Ubuntu-Description:
Notes:
 leosilva> PostgreSQL 9.3 is end of life upstream, and no updates are
 leosilva> are available. Marking as deferred in -esm-main releases.
 leosilva> PostgreSQL 9.3 is end of life upstream, and no updates are
 leosilva> are available. Marking as deferred in -esm-main releases.
 leosilva> PostgreSQL 9.3 is end of life upstream, and no updates are
 leosilva> are available. Marking as deferred in -esm-main releases.
 leosilva> PostgreSQL 9.3 is end of life upstream, and no updates are
 leosilva> are available. Marking as deferred in -esm-main releases.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H [8.0 HIGH]


Patches_postgresql-16:
upstream_postgresql-16: needs-triage
trusty_postgresql-16: DNE
xenial_postgresql-16: DNE
bionic_postgresql-16: DNE
focal_postgresql-16: DNE
jammy_postgresql-16: DNE
mantic_postgresql-16: DNE
devel_postgresql-16: needs-triage

Patches_postgresql-15:
upstream_postgresql-15: needs-triage
trusty_postgresql-15: DNE
xenial_postgresql-15: DNE
bionic_postgresql-15: DNE
focal_postgresql-15: DNE
jammy_postgresql-15: DNE
mantic_postgresql-15: needs-triage
devel_postgresql-15: DNE

Patches_postgresql-14:
upstream_postgresql-14: needs-triage
trusty_postgresql-14: DNE
xenial_postgresql-14: DNE
bionic_postgresql-14: DNE
focal_postgresql-14: DNE
jammy_postgresql-14: needs-triage
mantic_postgresql-14: DNE
devel_postgresql-14: DNE

Patches_postgresql-12:
upstream_postgresql-12: needs-triage
trusty_postgresql-12: ignored (end of standard support)
xenial_postgresql-12: DNE
bionic_postgresql-12: DNE
focal_postgresql-12: needs-triage
jammy_postgresql-12: DNE
mantic_postgresql-12: DNE
devel_postgresql-12: DNE

Patches_postgresql-10:
upstream_postgresql-10: needs-triage
trusty_postgresql-10: DNE
xenial_postgresql-10: DNE
bionic_postgresql-10: ignored (end of standard support)
esm-infra/bionic_postgresql-10: needs-triage
focal_postgresql-10: DNE
jammy_postgresql-10: DNE
mantic_postgresql-10: DNE
devel_postgresql-10: DNE

Patches_postgresql-9.5:
upstream_postgresql-9.5: needs-triage
trusty_postgresql-9.5: DNE
xenial_postgresql-9.5: ignored (end of standard support)
esm-infra/xenial_postgresql-9.5: needs-triage
bionic_postgresql-9.5: DNE
focal_postgresql-9.5: DNE
jammy_postgresql-9.5: DNE
mantic_postgresql-9.5: DNE
devel_postgresql-9.5: DNE

Patches_postgresql-9.3:
upstream_postgresql-9.3: needs-triage
trusty_postgresql-9.3: ignored (end of standard support)
trusty/esm_postgresql-9.3: deferred (2019-08-23)
xenial_postgresql-9.3: DNE
bionic_postgresql-9.3: DNE
focal_postgresql-9.3: DNE
jammy_postgresql-9.3: DNE
mantic_postgresql-9.3: DNE
devel_postgresql-9.3: DNE

Patches_postgresql-9.1:
upstream_postgresql-9.1: needs-triage
trusty_postgresql-9.1: ignored (end of standard support)
xenial_postgresql-9.1: DNE
bionic_postgresql-9.1: DNE
focal_postgresql-9.1: DNE
jammy_postgresql-9.1: DNE
mantic_postgresql-9.1: DNE
devel_postgresql-9.1: DNE
