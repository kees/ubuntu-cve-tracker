PublicDateAtUSN: 2023-12-06
Candidate: CVE-2023-45866
PublicDate: 2023-12-06
CRD: 2023-12-06
References:
 https://github.com/skysafe/reblog/tree/main/cve-2023-45866
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45866
 https://ubuntu.com/security/notices/USN-6540-1
Description:
 [The HID Profile in multiple Bluetooth host stacks may accept
 connections with the HID control and HID interrupt channels of
 the HID Host role without MITM protection/mitigation and without
 user confirmation on the Central role device. This can permit a
 device like a keyboard (or emulating a keyboard) to successfully
 connect to a discoverable device without confirmation and permit
 keystroke injection.]
Ubuntu-Description:
 It was discovered that BlueZ did not properly restrict non-bonded
 devices from injecting HID events into the input subsystem. This
 could allow a physically proximate attacker to inject keystrokes
 and execute arbitrary commands whilst the device is discoverable.
Notes:
 eslerm| underlying issue was addressed in CVE-2020-0556, but was
  not enabled and not compliant with Security Mode 4
 eslerm> patch released ahead of public CRD
Mitigation:
  In `/etc/bluetooth/input.conf` set `ClassicBondedOnly=true` and
  then `systemctl restart bluetooth`.
  Setting `ClassicBondedOnly=false` will re-enable legacy device
  support (like the PS3 controller) and the vulnerability.
Bugs:
Priority: medium
Discovered-by: Marc Newlin
Assigned-to: 0xnishit
CVSS:
 nvd: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]

Patches_bluez:
 upstream: https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675
upstream_bluez: needs-triage
trusty_bluez: ignored (end of standard support)
xenial_bluez: ignored (end of standard support)
esm-infra/xenial_bluez: released (5.37-0ubuntu5.3+esm3)
bionic_bluez: ignored (end of standard support)
esm-infra/bionic_bluez: released (5.48-0ubuntu3.9+esm1)
focal_bluez: released (5.53-0ubuntu3.7)
jammy_bluez: released (5.64-0ubuntu1.1)
lunar_bluez: released (5.66-0ubuntu1.1)
mantic_bluez: released (5.68-0ubuntu1.1)
devel_bluez: pending (5.70-0ubuntu3)
