PublicDateAtUSN: 2023-10-17 20:15:00 UTC
Candidate: CVE-2023-45803
PublicDate: 2023-10-17 20:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45803
 https://github.com/urllib3/urllib3/security/advisories/GHSA-g4mx-q9vg-27p4
 https://www.rfc-editor.org/rfc/rfc9110.html#name-get
 https://github.com/urllib3/urllib3/commit/4e98d57809dacab1cbe625fddeec1a290c478ea9
 https://ubuntu.com/security/notices/USN-6473-1
Description:
 urllib3 is a user-friendly HTTP client library for Python. urllib3
 previously wouldn't remove the HTTP request body when an HTTP redirect
 response using status 301, 302, or 303 after the request had its method
 changed from one that could accept a request body (like `POST`) to `GET` as
 is required by HTTP RFCs. Although this behavior is not specified in the
 section for redirects, it can be inferred by piecing together information
 from different sections and we have observed the behavior in other major
 HTTP client implementations like curl and web browsers. Because the
 vulnerability requires a previously trusted service to become compromised
 in order to have an impact on confidentiality we believe the exploitability
 of this vulnerability is low. Additionally, many users aren't putting
 sensitive data in HTTP request bodies, if this is the case then this
 vulnerability isn't exploitable. Both of the following conditions must be
 true to be affected by this vulnerability: 1. Using urllib3 and submitting
 sensitive information in the HTTP request body (such as form data or JSON)
 and 2. The origin service is compromised and starts redirecting using 301,
 302, or 303 to a malicious peer or the redirected-to service becomes
 compromised. This issue has been addressed in versions 1.26.18 and 2.0.7
 and users are advised to update to resolve this issue. Users unable to
 update should disable redirects for services that aren't expecting to
 respond with redirects with `redirects=False` and disable automatic
 redirects with `redirects=False` and handle 301, 302, and 303 redirects
 manually by stripping the HTTP request body.
 
Ubuntu-Description:
Notes:
 mdeslaur> On focal and earlier, the python-pip package bundles
 mdeslaur> python-urllib3 binaries when built. After updating
 mdeslaur> python-urllib3, a no-change rebuild of python-pip is required.
 mdeslaur> On jammy and later, python-urllib3 is bundled in the python-pip
 mdeslaur> package and needs to be patched.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: 
CVSS:
 nvd: CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N [4.2 MEDIUM]

Patches_python-urllib3:
 upstream: https://github.com/urllib3/urllib3/commit/4e98d57809dacab1cbe625fddeec1a290c478ea9
upstream_python-urllib3: needs-triage
trusty_python-urllib3: ignored (end of standard support)
trusty/esm_python-urllib3: needs-triage
xenial_python-urllib3: ignored (end of standard support)
esm-infra/xenial_python-urllib3: released (1.13.1-2ubuntu0.16.04.4+esm1)
bionic_python-urllib3: ignored (end of standard support)
esm-infra/bionic_python-urllib3: released (1.22-1ubuntu0.18.04.2+esm1)
focal_python-urllib3: released (1.25.8-2ubuntu0.3)
jammy_python-urllib3: released (1.26.5-1~exp1ubuntu0.1)
lunar_python-urllib3: released (1.26.12-1ubuntu0.1)
mantic_python-urllib3: released (1.26.16-1ubuntu0.1)
devel_python-urllib3: needs-triage

Patches_python-pip:
upstream_python-pip: needs-triage
trusty_python-pip: ignored (end of standard support)
trusty/esm_python-pip: needs-triage
xenial_python-pip: ignored (end of standard support)
esm-apps/xenial_python-pip: needs-triage
bionic_python-pip: ignored (end of standard support)
esm-apps/bionic_python-pip: needs-triage
focal_python-pip: needs-triage
esm-apps/focal_python-pip: needs-triage
jammy_python-pip: needs-triage
esm-apps/jammy_python-pip: needs-triage
lunar_python-pip: needs-triage
mantic_python-pip: needs-triage
devel_python-pip: needs-triage
