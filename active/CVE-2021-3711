PublicDateAtUSN: 2021-08-24
Candidate: CVE-2021-3711
CRD: 2021-08-24
PublicDate: 2021-08-24 15:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3711
 https://www.openssl.org/news/secadv/20210824.txt
 https://ubuntu.com/security/notices/USN-5051-1
Description:
 In order to decrypt SM2 encrypted data an application is expected to call
 the API function EVP_PKEY_decrypt(). Typically an application will call
 this function twice. The first time, on entry, the "out" parameter can be
 NULL and, on exit, the "outlen" parameter is populated with the buffer size
 required to hold the decrypted plaintext. The application can then allocate
 a sufficiently sized buffer and call EVP_PKEY_decrypt() again, but this
 time passing a non-NULL value for the "out" parameter. A bug in the
 implementation of the SM2 decryption code means that the calculation of the
 buffer size required to hold the plaintext returned by the first call to
 EVP_PKEY_decrypt() can be smaller than the actual size required by the
 second call. This can lead to a buffer overflow when EVP_PKEY_decrypt() is
 called by the application a second time with a buffer that is too small. A
 malicious attacker who is able present SM2 content for decryption to an
 application could cause attacker chosen data to overflow the buffer by up
 to a maximum of 62 bytes altering the contents of other data held after the
 buffer, possibly changing application behaviour or causing the application
 to crash. The location of the buffer is application dependent but is
 typically heap allocated. Fixed in OpenSSL 1.1.1l (Affected 1.1.1-1.1.1k).
Ubuntu-Description: 
Notes: 
Mitigation: 
Bugs: 
Priority: high
Discovered-by: John Ouyang
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_openssl:
upstream_openssl: released (1.1.1l)
trusty_openssl: ignored (out of standard support)
trusty/esm_openssl: not-affected
xenial_openssl: ignored (out of standard support)
esm-infra/xenial_openssl: not-affected
fips/xenial_openssl: not-affected
fips-updates/xenial_openssl: not-affected
bionic_openssl: released (1.1.1-1ubuntu2.1~18.04.13)
fips/bionic_openssl: needed
fips-updates/bionic_openssl: released (1.1.1-1ubuntu2.fips.2.1~18.04.13.2)
focal_openssl: released (1.1.1f-1ubuntu2.8)
fips/focal_openssl: needed
fips-updates/focal_openssl: released (1.1.1f-1ubuntu2.fips.7.2)
hirsute_openssl: released (1.1.1j-1ubuntu3.5)
impish_openssl: released (1.1.1l-1ubuntu1)
jammy_openssl: released (1.1.1l-1ubuntu1)
devel_openssl: released (1.1.1l-1ubuntu1)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: not-affected
focal_openssl1.0: DNE
hirsute_openssl1.0: DNE
impish_openssl1.0: DNE
jammy_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
trusty_nodejs: ignored (out of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
hirsute_nodejs: not-affected (uses system openssl1.1)
impish_nodejs: not-affected (uses system openssl1.1)
jammy_nodejs: not-affected (uses system openssl1.1)
esm-apps/jammy_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
upstream_edk2: needs-triage
trusty_edk2: ignored (out of standard support)
trusty/esm_edk2: DNE
xenial_edk2: not-affected (code not compiled)
esm-apps/xenial_edk2: not-affected (code not compiled)
bionic_edk2: not-affected (code not compiled)
esm-apps/bionic_edk2: not-affected (code not compiled)
focal_edk2: not-affected (code not compiled)
hirsute_edk2: not-affected (code not compiled)
impish_edk2: not-affected (code not compiled)
jammy_edk2: not-affected (code not compiled)
devel_edk2: not-affected (code not compiled)
