Candidate: CVE-2023-25193
PublicDate: 2023-02-04 20:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-25193
 https://github.com/harfbuzz/harfbuzz/blob/2822b589bc837fae6f66233e2cf2eef0f6ce8470/src/hb-ot-layout-gsubgpos.hh
 https://chromium.googlesource.com/chromium/src/+/e1f324aa681af54101c1f2d173d92adb80e37088/DEPS#361
 https://github.com/harfbuzz/harfbuzz/commit/85be877925ddbf34f74a1229f3ca1716bb6170dc
Description:
 hb-ot-layout-gsubgpos.hh in HarfBuzz through 6.0.0 allows attackers to
 trigger O(n^2) growth via consecutive marks during the process of looking
 back for base glyphs when attaching marks.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> commit 85be877925ddbf34f74a1229f3ca1716bb6170dc that was
  claimed to fix the issue, got reverted in commit
  661050b4659ee490dfe622821bc7fde7d1c40510, there are comments on the first
  discussing possible regressions. Instead, the commits listed in the
  patches section seems to properly fix the issue.
 rodrigo-zaiden> for commit 30b84faba, _infos_set_glyph_flags() can be
  found as _unsafe_to_break_set_mask() for versios prior to 3.3.0, down to
  version 1.5.0, where the later was added.
 rodrigo-zaiden> GPOS lookups (src/OT/Layout/GPOS) moved to the current
  code baseline in version 4.4.1, before it, some of the methods can be
  found in src/hb-ot-layout-gsubgpos.hh.
 rodrigo-zaiden> releases prior to bionic does not have any of the code
  being fixed. bionic itself could be patched with some of the commits, but
  not all. a careful check seems necessary to evaluate if really possible
  to fix it.
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1030612
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_harfbuzz:
 upstream: https://github.com/harfbuzz/harfbuzz/commit/8708b9e081192786c027bb7f5f23d76dbe5c19e8
 upstream: https://github.com/harfbuzz/harfbuzz/commit/30b84faba7811bed1b7c9828afd719f20e0086da
 upstream: https://github.com/harfbuzz/harfbuzz/commit/1930760bc2c2b4185a772e38b6ecc174a95a47b2
 upstream: https://github.com/harfbuzz/harfbuzz/commit/64fa5cd482d0be2e215998aa1c2a05b978133e7c
upstream_harfbuzz: released (7.0.0)
esm-infra/xenial_harfbuzz: not-affected (code not present)
trusty_harfbuzz: ignored (out of standard support)
xenial_harfbuzz: ignored (out of standard support)
bionic_harfbuzz: needs-triage
focal_harfbuzz: needed
jammy_harfbuzz: needed
kinetic_harfbuzz: needed
trusty/esm_harfbuzz: not-affected (code not present)
devel_harfbuzz: needed
